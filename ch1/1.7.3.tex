\sectionlabel{Exercise 1.7.3.}

\begin{stm}{stm:setup173}[exercise]
Show that the eigenvalues of a two-dimensional hyperbolic toral automorphism are irrational (so the stable and unstable manifolds are dense by exercise 1.11.1).
\end{stm}

\sectionlabel{Proof {\color{blue} + reasoning}:}

\begin{stm}{stm:q3}[reasoning]
Are there hyperbolic toral automorphisms that aren't represented by a matrix? No, not in this context.
\end{stm}

\begin{stm}{stm:4}[final-proof]
Let $A$ be a $2 \times 2$ integer matrix such that $\det(A) = 1$ and such that for all eigenvalues $\lambda$ of $A$, $|\lambda| \neq 1$.
\end{stm}

\begin{stm}{stm:5}[final-proof]
Let $\lambda$ be an eigenvalue of $A$.
\end{stm}

\begin{stm}{stm:6}[reasoning]
Let's try the following: first, relate the eigenvalues to the determinant. Then, conclude from the first step and the given assumptions that the eigenvalues are irrational.
\end{stm}

\begin{stm}{stm:8}[final-proof]
Note that $\det(\lambda I - A) = 0$.
\end{stm}

\begin{stm}{stm:8a}[final-proof]
Denote $A = \begin{bmatrix} a_{11} & a_{12} \\ a_{21} & a_{22} \end{bmatrix}$.
\end{stm}

\begin{stm}{stm:9}[final-proof]
$(\lambda - a_{11})(\lambda - a_{22}) - a_{12}a_{21} = 0$
\end{stm}

\begin{stm}{stm:10}[final-proof]
$\lambda^2 - \lambda a_{11} - \lambda a_{22} + a_{11}a_{22} - a_{12}a_{21} = 0$
\end{stm}

\begin{stm}{stm:12}[final-proof]
By assumption, $\det(A) = 1$, so $a_{11}a_{22} - a_{12}a_{21} = 1$
\end{stm}

\begin{stm}{stm:13}[final-proof]
Substituting $1 = a_{11}a_{22} - a_{12}a_{21}$ in \ref{stm:10} gives: $\lambda^2 - \lambda a_{11} - \lambda a_{22} + 1 = 0$
\end{stm}

\begin{stm}{stm:14}[final-proof]
$\lambda^2 - \lambda(a_{11} + a_{22}) + 1 = 0$
\end{stm}

\begin{stm}{stm:14b}[reasoning]
That was the first step. How can we conclude?
\end{stm}

\begin{stm}{stm:r15}[reasoning]
What given assumption have I not used yet?
\end{stm}

\begin{stm}{stm:r16}[reasoning]
I haven't used that $|\lambda| \ne 1$. From \ref{stm:14} it may be possible to conclude that $\lambda$ is equal to $1$ or irrational, which together with \ref{stm:r16} gives that $\lambda$ is irrational.
\end{stm}

\begin{stm}{stm:r17}[reasoning]
We can factorize the left-hand side of \ref{stm:14}.
\end{stm}

\begin{stm}{stm:r20}[reasoning]
However, \ref{stm:14} could have complex solutions for certain values of $a_{11} + a_{22}$.
\end{stm}

\begin{stm}{stm:26}[reasoning]
If the discriminant of \ref{stm:14} is greater than $0$, \ref{stm:14} only has real roots.
\end{stm}

\begin{stm}{stm:insert27a}[reasoning]
I'm not sure how to proceed. Let's take a few steps back.
\end{stm}

\begin{stm}{stm:27}[reasoning]
Equation \ref{stm:14} is quadratic in $\lambda$, so all solutions are given by the quadratic formula.
\end{stm}

\begin{stm}{stm:15}[final-proof]
By the quadratic formula, $\lambda = \frac{1}{2}(a_{11} + a_{22} + ((a_{11} + a_{22})^2 - 4)^{1/2})$ or $\lambda = \frac{1}{2}(a_{11} + a_{22} - ((a_{11} + a_{22})^2 - 4)^{1/2})$
\end{stm}

\begin{stm}{stm:16}[final-proof]
From \ref{stm:15} we see that $\lambda \in \mathbb{R} \setminus \mathbb{Q}$ if and only if $((a_{11} + a_{22})^2 - 4)^{1/2} \in \mathbb{R} \setminus \mathbb{Q}$
\end{stm}

\begin{stm}{stm:17}[final-proof]
By definition of $A$, $(a_{11} + a_{22}) \in \mathbb{N}$
\end{stm}

\begin{stm}{stm:insert18a}[reasoning]
Let's show that $\lambda$ cannot be in $\mathbb{C}$. My guess is that if $\lambda$ were in $\mathbb{C}$, its magnitude would be equal to $1$.
\end{stm}

\begin{stm}{stm:a18}[final-proof]
Suppose $((a_{11} + a_{22})^2 - 4)^{1/2} \in \mathbb{C}$. Then $|\lambda|^2 = \frac{1}{4}((a_{11} + a_{22})^2 + 4 - (a_{11} + a_{22})^2) = 1$
\end{stm}

\begin{stm}{stm:20}[final-proof]
\ref{stm:a18} contradicts \ref{stm:4}, hence $((a_{11} + a_{22})^2 - 4)^{1/2} \in \mathbb{R}$
\end{stm}

\begin{stm}{stm:21}[final-proof]
From \ref{stm:20} and \ref{stm:17}, $a_{11} + a_{22} \geq 3$
\end{stm}

\begin{stm}{stm:22}[reasoning]
We just need to show that $\lambda \notin \mathbb{Q}$. My intuition is that $((a_{11} + a_{22})^2 - 4)^{1/2}$ is always irrational, because it seems $\forall n \in \mathbb{N}$, $n^{1/2}$ is rational only if $n$ is a square number, and subtracting $4$ makes it no longer square, given $\sqrt{n} \ge 3$. Let's prove the first part.
\end{stm}

\begin{stm}{stm:c23}[final-proof]
Conjecture: $\{n \in \mathbb{N} : \sqrt{n} \in \mathbb{Q} \setminus \mathbb{N} \} = \emptyset$
\end{stm}

\begin{stm}{stm:a28}[final-proof]
Proof of \ref{stm:c23}: Suppose $\sqrt{n} \in \mathbb{Q} \setminus \mathbb{N}$. Then $\sqrt{n} = \frac{p}{q}$, where $p$ and $q$ are natural numbers.
\end{stm}

\begin{stm}{stm:30}[final-proof]
Since $\sqrt{n} \notin \mathbb{N}$, $q$ does not divide $p$, so $q^2$ does not divide $p^2$
\end{stm}

\begin{stm}{stm:31}[final-proof]
From \ref{stm:a28}, $n = \frac{p^2}{q^2}$, hence $n q^2 = p^2$
\end{stm}

\begin{stm}{stm:32}[final-proof]
\ref{stm:30} contradicts \ref{stm:31}, so \ref{stm:a28} is false $\square_{c23}$
\end{stm}

\begin{stm}{stm:insert33a}[reasoning]
Now let's prove the second part, that subtracting 4 makes the number no longer square. Intuitively, this seems true because the distance between consecutive squares will eventually be greater than any fixed number, like 4, so by subtracting a fixed number from large enough squares, we end up in between squares.
\end{stm}

\begin{stm}{stm:c34}[final-proof]
Conjecture: $\forall n \in \mathbb{N}, n \ge 3$ implies $(n^2 - 4)^{1/2} \notin \mathbb{N}$
\end{stm}

\begin{stm}{stm:a35}[final-proof]
Proof of \ref{stm:c34}: Suppose $(n^2 - 4)^{1/2} = k$ where $k \in \mathbb{N}$
\end{stm}

\begin{stm}{stm:36}[final-proof]
Then $n^2 - 4 = k^2$
\end{stm}

\begin{stm}{stm:37}[final-proof]
So $n^2 - k^2 = 4$
\end{stm}

\begin{stm}{stm:38}[final-proof]
Clearly, $n > k$
\end{stm}

\begin{stm}{stm:39}[final-proof]
Then $n^2 - k^2 \ge n^2 - (n - 1)^2 = n^2 - n^2 + 2n - 1 = 2n - 1$
\end{stm}

\begin{stm}{stm:41}[final-proof]
So $n^2 - k^2 > 4$
\end{stm}

\begin{stm}{stm:42}[final-proof]
\ref{stm:41} contradicts \ref{stm:37}, so $\square_{c34}$
\end{stm}

\begin{stm}{stm:43}[final-proof]
Now we can conclude. By \ref{stm:21} and \ref{stm:c34}, $((a_{11} + a_{22})^2 - 4)^{1/2} \notin \mathbb{N}$
\end{stm}

\begin{stm}{stm:44}[final-proof]
So, by \ref{stm:43}, \ref{stm:20} and \ref{stm:c23}, $((a_{11} + a_{22})^2 - 4)^{1/2}$ is irrational
\end{stm}

\begin{stm}{stm:45}[final-proof]
So, by \ref{stm:44} and \ref{stm:15}, $\lambda$ is irrational
\end{stm}

\begin{stm}{stm:insert45a}[reasoning]
We still need to show that the (un)stable manifolds are dense by exercise 1.11.1.
\end{stm}

\begin{stm}{stm:46}[final-proof]
Let $x \in \mathbb{T}^2$. Without loss of generality, $\lambda > 1 > \lambda^{-1}$, where $\lambda$ and $\lambda^{-1}$ are the eigenvalues of $A$. The stable manifold $W^u(x)$ is the line through $x$ parallel to $v$ where $v$ is the eigenvector corresponding to $\lambda$.
\end{stm}

\begin{stm}{stm:insert47a}[reasoning]
I think the intended proof is to show that the slope of a line parallel to $v$ is irrational, hence the flow defined in section 1.11 has dense orbits, from which it follows $W^u(x)$ is dense.
\end{stm}

\begin{stm}{stm:49}[final-proof]
Denote $v = \begin{pmatrix} v_1 \\ v_2 \end{pmatrix}$. A line parallel to $v$ has slope equal to $\frac{v_2}{v_1}$
\end{stm}

\begin{stm}{stm:insert50a}[reasoning]
My guess is that the slope is irrational because $\lambda$ is irrational and because $v$ is an eigenvector of an integer-valued matrix. Let's write out the defining equation for eigenvectors.
\end{stm}

\begin{stm}{stm:52}[final-proof]
$A v = \lambda v$
\end{stm}

\begin{stm}{stm:53}[final-proof]
$\begin{bmatrix} a_{11}v_1 + a_{12}v_2 \\ a_{21}v_1 + a_{22}v_2 \end{bmatrix} = \begin{bmatrix} \lambda v_1 \\ \lambda v_2 \end{bmatrix}$
\end{stm}

\begin{stm}{stm:55}[final-proof]
$a_{11}v_1 + a_{12}v_2 = \lambda v_1$
\end{stm}

\begin{stm}{stm:56}[final-proof]
$a_{21}v_1 + a_{22}v_2 = \lambda v_2$
\end{stm}

\begin{stm}{stm:57}[final-proof]
$v_2(\lambda - a_{22}) = a_{21}v_1$
\end{stm}

\begin{stm}{stm:58}[final-proof]
$v_1(\lambda - a_{11}) = a_{12}v_2$
\end{stm}

\begin{stm}{stm:59b}[reasoning]
If $a_{21} = 0$, then $v_2 v_1^{-1} = 0$. Why is this not possible? Probably because $v$ is nonzero, by assumption.
\end{stm}

\begin{stm}{stm:59c}[final-proof]
Since $v$ is an eigenvector, $v_1 \ne 0$ or $v_2 \ne 0$
\end{stm}

\begin{stm}{stm:59e}[final-proof]
By \ref{stm:45}, $(\lambda - a_{22})$ and $(\lambda - a_{11})$ are irrational.
\end{stm}

\begin{stm}{stm:59f}[final-proof]
If $v_1 \ne 0$, then by \ref{stm:59e} and \ref{stm:58}, $v_2 \ne 0$
\end{stm}

\begin{stm}{stm:59g}[final-proof]
If $v_2 \ne 0$, then by \ref{stm:59e} and \ref{stm:57}, $v_1 \ne 0$
\end{stm}

\begin{stm}{stm:59h}[final-proof]
So, $v_1 \ne 0$ and $v_2 \ne 0$
\end{stm}

\begin{stm}{stm:59i}[final-proof]
By \ref{stm:59h} and \ref{stm:57}, $v_2 v_1^{-1} = (\lambda - a_{22})^{-1} a_{21} \ne 0$
\end{stm}

\begin{stm}{stm:59j}[final-proof]
By \ref{stm:59i} and \ref{stm:59e}, $v_2 v_1^{-1}$ is irrational
\end{stm}

\begin{stm}{stm:62}[final-proof]
Denote $x = (x_1, x_2)$, let $t \in \mathbb{R}^+$
\end{stm}

\begin{stm}{stm:63}[final-proof]
Let $\phi_{\frac{v_1}{v_2}}^t(x) := (x_1 + \frac{v_1}{v_2} t, x_2 + t) \mod 1$
\end{stm}

\begin{stm}{stm:64}[final-proof]
Then $\bigcup_{t \in \mathbb{R}^+} \phi_{\frac{v_1}{v_2}}^t(x) \subseteq W^u(x)$
\end{stm}

\begin{stm}{stm:65}[final-proof]
By exercise 1.11.1, the orbit of $\phi_{\frac{v_1}{v_2}}$ is dense, so $W^u(x)$ is dense. For the stable manifold, the proof is similar.
\end{stm}
